/*! angular-date-range-picker 2014-10-03 */
(function(){angular.module("dateRangePicker",["pasvaz.bindonce"]),angular.module("dateRangePicker").directive("dateRangePicker",["$compile","$timeout","$http","$templateCache","$q",function(a,b,c,d,e){var f,g,h,i;return i='<div ng-show="visible" class="angular-date-range-picker__picker" ng-click="handlePickerClick($event)" ng-class="{\'angular-date-range-picker--ranged\': showRanged }">\n  <div class="angular-date-range-picker__timesheet">\n    <a ng-click="move(-1, $event)" class="angular-date-range-picker__prev-month">&#9664;</a>\n    <div bindonce ng-repeat="month in months" class="angular-date-range-picker__month">\n      <div class="angular-date-range-picker__month-name" bo-text="month.name"></div>\n      <table class="angular-date-range-picker__calendar">\n        <tr>\n          <th bindonce ng-repeat="day in month.weeks[1]" class="angular-date-range-picker__calendar-weekday" bo-text="day.date.format(\'dd\')">\n          </th>\n        </tr>\n        <tr bindonce ng-repeat="week in month.weeks">\n          <td\n              bo-class=\'{\n                "angular-date-range-picker__calendar-day": day,\n                "angular-date-range-picker__calendar-day-selected": day.selected,\n                "angular-date-range-picker__calendar-day-disabled": day.disabled,\n                "angular-date-range-picker__calendar-day-start": day.start\n              }\'\n              ng-repeat="day in week track by $index" ng-click="select(day, $event)">\n              <div class="angular-date-range-picker__calendar-day-wrapper" bo-text="day.date.date()"></div>\n          </td>\n        </tr>\n      </table>\n    </div>\n    <a ng-click="move(+1, $event)" class="angular-date-range-picker__next-month">&#9654;</a>\n  </div>\n  <div class="angular-date-range-picker__panel">\n    <div ng-show="showRanged">\n      Select range: <select ng-click="prevent_select($event)" ng-model="quick" ng-options="e.range as e.label for e in quickList"></select>\n    </div>\n    <div class="angular-date-range-picker__buttons">\n      <a ng-click="ok($event)" class="angular-date-range-picker__apply">Apply</a>\n      <a ng-click="hide($event)" class="angular-date-range-picker__cancel">cancel</a>\n    </div>\n  </div>\n</div>',h='<span tabindex="0" ng-keydown="hide()" class="angular-date-range-picker__input">\n  <span ng-if="showRanged">\n    <span ng-show="!!model">{{ model.start.format("ll") }} - {{ model.end.format("ll") }}</span>\n    <span ng-hide="!!model">Select date range</span>\n  </span>\n  <span ng-if="!showRanged">\n    <span ng-show="!!model">{{ model.format("ll") }}</span>\n    <span ng-hide="!!model">Select date</span>\n  </span>\n</span>',f="CUSTOM",g=function(a){var b;return b=e.defer(),a?c.get(a,{cache:d}).success(function(a){return b.resolve(a)}).error(function(a){return b.reject(a),new Error("Could not load angular-date-range-picker template, reason "+a)}):b.resolve(h),b.promise},{restrict:"AE",replace:!0,scope:{model:"=ngModel",customSelectOptions:"=",ranged:"=",pastDates:"@",callback:"&",pickerTemplateUrl:"=",inputTemplateUrl:"="},link:function(c,d){var e,h,j,k,l;return g(c.inputTemplateUrl).then(function(b){var e,f;return f=a(b)(c),d.replaceWith(f),d=angular.element(f),e=c.pickerTemplateUrl?a(angular.element("<div ng-include=\"'"+c.pickerTemplateUrl+"'\"></div>"))(c):a(angular.element(i))(c),d.append(e),d.bind("click",function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),c.$apply(function(){return c.visible?c.hide():c.show()})})}),c.quickListDefinitions=c.customSelectOptions,null==c.quickListDefinitions&&(c.quickListDefinitions=[{label:"This week",range:moment().range(moment().startOf("week").startOf("day"),moment().endOf("week").startOf("day"))},{label:"Next week",range:moment().range(moment().startOf("week").add(1,"week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This fortnight",range:moment().range(moment().startOf("week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This month",range:moment().range(moment().startOf("month").startOf("day"),moment().endOf("month").startOf("day"))},{label:"Next month",range:moment().range(moment().startOf("month").add(1,"month").startOf("day"),moment().add(1,"month").endOf("month").startOf("day"))}]),c.quick=null,c.range=null,c.selecting=!1,c.visible=!1,c.start=null,c.showRanged=void 0===c.ranged?!0:c.ranged,k=function(a){var b,d,e,g,h;if(null==a&&(a=!1),c.showRanged){for(c.quickList=[],a&&c.quickList.push({label:"Custom",range:f}),g=c.quickListDefinitions,h=[],d=0,e=g.length;e>d;d++)b=g[d],h.push(c.quickList.push(b));return h}},h=function(){var a,b;return c.showRanged?c.range=c.selection?(b=c.selection.start.clone().startOf("month").startOf("day"),a=b.clone().add(2,"months").endOf("month").startOf("day"),moment().range(b,a)):moment().range(moment().startOf("month").subtract(1,"month").startOf("day"),moment().endOf("month").add(1,"month").startOf("day")):(c.selection=!1,c.selection=c.model||!1,c.date=moment(c.model)||moment(),c.range=moment().range(moment(c.date).startOf("month"),moment(c.date).endOf("month")))},j=function(){var a,b,d,e;if(c.showRanged&&c.selection){for(e=c.quickList,b=0,d=e.length;d>b;b++)if(a=e[b],a.range!==f&&c.selection.start.startOf("day").unix()===a.range.start.startOf("day").unix()&&c.selection.end.startOf("day").unix()===a.range.end.startOf("day").unix())return c.quick=a.range,void k();return c.quick=f,k(!0)}},l=function(){var a,b,d,e,f,g;for(c.months=[],d=12*c.range.start.year()+c.range.start.month(),b=moment().startOf("week").day(),c.range.by("days",function(a){var e,f,g,h,i,j,k;return e=a.day()-b,0>e&&(e=7+e),g=12*a.year()+a.month()-d,i=parseInt((7+a.date()-e)/7),h=!1,f=!1,c.showRanged?c.start?(h=a===c.start,f=a<c.start):h=c.selection&&c.selection.contains(a):(h=a.isSame(c.selection),c.pastDates&&(f=moment().diff(a,"days")>0)),(j=c.months)[g]||(j[g]={name:a.format("MMMM YYYY"),weeks:[]}),(k=c.months[g].weeks)[i]||(k[i]=[]),c.months[g].weeks[i][e]={date:a,selected:h,disabled:f,start:c.start&&c.start.unix()===a.unix()}}),g=c.months,e=0,f=g.length;f>e;e++)a=g[e],a.weeks[0]||a.weeks.splice(0,1);return j()},c.show=function(){return c.selection=c.model,h(),l(),c.visible=!0},c.hide=function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),c.visible=!1,c.start=null},c.prevent_select=function(a){return null!=a&&"function"==typeof a.stopPropagation?a.stopPropagation():void 0},c.ok=function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),c.model=c.selection,b(function(){return c.callback?c.callback():void 0}),c.hide()},c.select=function(a,b){return null!=b&&"function"==typeof b.stopPropagation&&b.stopPropagation(),a.disabled?void 0:(c.showRanged?(c.selecting=!c.selecting,c.selecting?c.start=a.date:(c.selection=moment().range(c.start,a.date),c.start=null)):c.selection=moment(a.date),l())},c.move=function(a,b){return null!=b&&"function"==typeof b.stopPropagation&&b.stopPropagation(),c.showRanged?c.range=moment().range(c.range.start.add(a,"months").startOf("month").startOf("day"),c.range.start.clone().add(2,"months").endOf("month").startOf("day")):(c.date.add(a,"months"),c.range=moment().range(moment(c.date).startOf("month"),moment(c.date).endOf("month"))),l()},c.handlePickerClick=function(a){return null!=a&&"function"==typeof a.stopPropagation?a.stopPropagation():void 0},c.$watch("quick",function(a){return a&&a!==f?(c.selection=c.quick,c.selecting=!1,c.start=null,h(),l()):void 0}),c.$watch("customSelectOptions",function(a){return"undefined"!=typeof customSelectOptions&&null!==customSelectOptions?c.quickListDefinitions=a:void 0}),e=function(){return c.$apply(function(){return c.hide()}),!0},angular.element(document).bind("click",e),c.$on("$destroy",function(){return angular.element(document).unbind("click",e)}),k(),h(),l()}}}])}).call(this);